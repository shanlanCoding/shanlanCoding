<% if (typeof(script) !== 'undefined' && script) { %>
<%#  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script> %>
<%#  上面的js引用地址失效，现替换如下地址 2022年8月10日21/59/32%>
<script src="//code.bdstatic.com/npm/leancloud-storage@4.12.0/dist/av-min.js"></script>

  <script src="//cdn.jsdelivr.net/npm/valine"></script>
  <script type="text/javascript">

  var GUEST = ['nick', 'mail', 'link'];

  var meta = '<%= theme.comment.valine.meta %>';
  meta = meta.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });

  var requiredFields = '<%= theme.comment.valine.requiredFields %>';
  requiredFields  = requiredFields.split(',');


  new Valine({
    el: '#vcomments',
    verify: <%= theme.comment.valine.verify %>,
    notify: <%= theme.comment.valine.notify %>,
    appId: '<%= theme.comment.valine.appid %>',
    appKey: '<%= theme.comment.valine.appkey %>',
    placeholder: '<%= theme.comment.valine.placeholder %>',
    avatar: '<%= theme.comment.valine.avatar %>',
    meta: meta,
    pageSize: '<%= theme.comment.valine.pageSize %>' || 10,
    visitor: <%= theme.comment.valine.visitor %>,
    requiredFields: requiredFields,
  });
  </script>
<% } %>
